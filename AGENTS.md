# Repository Guidelines

## Project Structure & Module Organization
Source lives in `src/hephaestus`, with CLI entrypoints in `cli.py`, orchestration logic split across `agent_controller.py`, `task_distributor.py`, and helpers in `utils/`. Tests mirror that layout under `test/unit` and scenario-driven checks in `test/integration`. Rendered docs and samples stay in `doc/` and `media/`, while distribution artifacts land in `dist/`. Use `templates/` for any autogenerated agent prompts or config stubs.

## Build, Test, and Development Commands
- `pip install -e .` installs the package in editable mode for local hacking.
- `python3 -m build` produces wheels/sdists into `dist/` for release testing.
- `uv tool install dist/hephaestus-*.whl` verifies the built wheel in a clean environment.
- `pytest` or `pytest test/unit` runs the default suite; add `-k "<pattern>"` when iterating on a subset.
- `hephaestus init --agent-type claude && hephaestus attach --create` exercises the CLI against a sandbox project to validate end-to-end flows.

## Coding Style & Naming Conventions
Target Python 3.10+ with four-space indentation, explicit type hints, and dataclasses (see `config.py`) for structured data. Favor small, single-responsibility modules and keep public CLI surface limited to `hephaestus.cli:main`. Internal functions follow `snake_case`, classes use `PascalCase`, and constants are uppercase. The repo does not enforce a specific formatter, so stick to Black-compatible layouts, keep imports sorted (use `isort` locally if you prefer), and route logging through the shared utilities instead of `print`.

## Testing Guidelines
Pytest backs all suites; new features require unit coverage alongside happy-path and failure-path integration cases. Name files `test_<subject>.py` and tests `test_<behavior>`. Use fixtures from `test/conftest.py` for temporary workspaces and avoid hard-coding user directories. Keep coverage steady by exercising agent configuration parsing, tmux interactions (mocked), and communication flows before opening a PR.

## Commit & Pull Request Guidelines
Follow the existing imperative, present-tense commit style (`Refactor agent controller layout`). Group related changes into focused commits and reference issues in the body when applicable. PRs should summarize the change, note any doc or config updates, list validation commands (e.g., `pytest`, `python3 -m build`), and include screenshots or logs for TUI updates. Request a reviewer familiar with the touched module and wait for green CI before merging.

## Operations & Configuration Notes
User-facing defaults live in `.hephaestus-work/config.yaml`; never commit environment-specific secrets. Document non-obvious tmux bindings or agent persona tweaks in `doc/commands/` so downstream operators can reproduce your setup. When adding new agent types, extend `create_default_config` and update both README variants plus sample configs to keep tooling aligned.
